<div class="container fullheight form-new" id="resize-button" data-controller="step-form">

  <div class= "row">
   <h1 style="text-align:center; margin-top: 15px"> Share with us your cultural experience <h1>
  </div>

  <%= simple_form_for @post,
                      html: {
                        data: {
                          controller: 'post-form'
                        }
                      } do |f| %>

    <%# ETAPE 1 : JE SELECTIONNE UN TOI %>
  <section class="form-step-1" data-step-form-target="step1">
    <%= f.input :toi,
                collection: Toi.all,
                label_method: :title,
                value_method: :title,
                label: false,
                wrapper: false,
                input_html: {
                  class: 'simple-form-input no-hover',
                  placeholder: "J'ai un avis sur ...",
                  data: {
                    post_form_target: 'selectInput',
                    action: 'input->post-form#showToiInputs'
                  }
                } %>

      <%# ETAPE 1-BIS : LE TOI N'EXISTE PAS %>
    <div class="d-none" data-post-form-target="newToiForm">
      <%= f.simple_fields_for(:toi) do |ff| %>
        <%= ff.input :description,
                      placeholder: "Description",
                      label: false,
                      input_html: {
                        class: 'simple-form-input'
                      } %>
        <%= ff.association :category,
                            prompt: "Choisis ta catÃ©gorie",
                            label: false,
                            input_html: {
                              class: "simple-form-input",
                              data: {
                                action: 'input->post-form#showInputs'
                              }
                            } %>
        <%= ff.input :trailer,
                      placeholder: "Trailer",
                      label: false,
                      wrapper_html: {
                        class: "d-none",
                        data: { post_form_target: "trailer"}
                      },
                      input_html: {
                        class: 'simple-form-input',
                        data: {
                          post_form_target: 'trailerInput'
                        }
                      } %>
        <%= ff.input :location,
                      placeholder: "Lieu",
                      label: false,
                      wrapper_html: {
                        class: "d-none",
                        data: { post_form_target: "location"}
                      },
                      input_html: {
                        class: 'simple-form-input'
                      } %>
        <%#= ff.input :photo,
                      as: :file,
                      placeholder: "Image",
                      label: false,
                      input_html: {
                        class: 'simple-form-input'
                      } %>
        <div class="mb-3 d-flex justify-content-center">
          <label for="photo-upload" class="custom-file-upload" data-post-form-target="label">
            <i class="fa-solid fa-camera"></i> Choisis une photo
          </label>
          <%= f.file_field :photo, class: "simple-form-input d-none", id: "photo-upload", data: { post_form_target: 'input' } %>
        </div>
      <% end %>
    </div>
    <button class="btn-next" data-action="click->step-form#next" data-step-form-target="nextButton">
      <i class="fw-bold text-white fa-solid fa-arrow-right"></i>
    </button>
  </section>

  <section class="form-step-2" data-step-form-target="step2">
      <%# ETAPE 2 : UN RATING, UN COMMENTAIRE %>
    <%= f.input :rating,
                placeholder: "Note",
                collection: (1..5),
                include_blank: "Donne une note",
                label: false,
                input_html: {
                  class: 'simple-form-input',
                  data: {
                    controller: "star-rating",
                  }
                } %>
    <%= f.input :review,
                placeholder: "Commentaire",
                label: false,
                input_html: {
                  rows: 4,
                  class: 'simple-form-input',
                } %>

    <%= f.button :submit,
                  "Partager",
                  class: "btn btn-success mt-3 simple-form-button" %>
  </section>


    <% if @post.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>
        <ul>
          <% @post.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

  <% end %>

</div>
